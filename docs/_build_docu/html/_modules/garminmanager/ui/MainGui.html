
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>garminmanager.ui.MainGui &#8212; garminmanager 0.0.post0.dev5+g199f32c.dirty documentation</title>
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for garminmanager.ui.MainGui</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">garminmanager.ui.MainGui_auto</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="k">import</span> <span class="n">listdir</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="k">import</span> <span class="n">isfile</span><span class="p">,</span> <span class="n">join</span>

<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="k">import</span> <span class="n">QFileDialog</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="k">import</span> <span class="n">QDir</span>

<span class="c1">#from FitParserC import *</span>
<span class="c1">#from myTypes.xyPairC import xyPairC</span>
<span class="kn">import</span> <span class="nn">matplotlib.dates</span> <span class="k">as</span> <span class="nn">mdates</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;QT5Agg&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">dateutil</span> <span class="k">import</span> <span class="n">tz</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">shutil</span>

<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_qt5agg</span> <span class="k">import</span> <span class="n">FigureCanvasQTAgg</span> <span class="k">as</span> <span class="n">FigureCanvas</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_qt5agg</span> <span class="k">import</span> <span class="n">NavigationToolbar2QT</span> <span class="k">as</span> <span class="n">NavigationToolbar</span>

<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_qt5agg</span> <span class="k">import</span> <span class="p">(</span><span class="n">NavigationToolbar2QT</span> <span class="k">as</span> <span class="n">NavigationToolbar</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">matplotlib.figure</span> <span class="k">import</span> <span class="n">Figure</span>

<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="k">import</span> <span class="n">host_subplot</span>
<span class="kn">import</span> <span class="nn">mpl_toolkits.axisartist</span> <span class="k">as</span> <span class="nn">AA</span>

<div class="viewcode-block" id="MainWindow"><a class="viewcode-back" href="../../../api/garminmanager.ui.html#garminmanager.ui.MainGui.MainWindow">[docs]</a><span class="k">class</span> <span class="nc">MainWindow</span><span class="p">(</span><span class="n">Ui_MainWindow</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Dialog</span><span class="p">,</span><span class="n">DialogInterface</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_test_callback</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figure</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Dialog</span> <span class="o">=</span> <span class="n">Dialog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_DialogInterface</span> <span class="o">=</span> <span class="n">DialogInterface</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span> <span class="o">=</span> <span class="p">[]</span>

<div class="viewcode-block" id="MainWindow.PrepareApplication"><a class="viewcode-back" href="../../../api/garminmanager.ui.html#garminmanager.ui.MainGui.MainWindow.PrepareApplication">[docs]</a>    <span class="k">def</span> <span class="nf">PrepareApplication</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;settings.json&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">read_file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">read_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mTextTB</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;FitSourceFolder:&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mTextTB</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="p">[</span><span class="s2">&quot;FitSourceFolder&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mTextTB</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;FitDstFolder:&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mTextTB</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="p">[</span><span class="s2">&quot;FitDstFolder&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mTextTB</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;FitBackupFolder:&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mTextTB</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="p">[</span><span class="s2">&quot;FitBackupFolder&quot;</span><span class="p">])</span>

        <span class="c1"># Right place for image in label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labelMainPic</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;./images/fenix3.jpg&quot;</span><span class="p">))</span></div>



<div class="viewcode-block" id="MainWindow.register_signals"><a class="viewcode-back" href="../../../api/garminmanager.ui.html#garminmanager.ui.MainGui.MainWindow.register_signals">[docs]</a>    <span class="k">def</span> <span class="nf">register_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">MainWindow</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mTestPB</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PrintOverlay</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mProcessPB</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ProcessHeartrate</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ParseToFileButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ParseAndWrite</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mBackupPB</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BackupData</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mGetDataFromWatchPB</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetDataFromWatch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionVersion</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TestFunction</span><span class="p">)</span>



        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_DialogInterface</span><span class="o">.</span><span class="n">labelPciture</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;./images/fenix3.jpg&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_DialogInterface</span><span class="o">.</span><span class="n">VersionLabel</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Version: 2.0.0&quot;</span><span class="p">)</span>
        <span class="c1"># self._figure = plt.figure()</span>
        <span class="c1"># ax1 = self._figure.add_subplot(111)</span>
        <span class="c1"># bins = np.arange(0.6, 1.62, 0.02)</span>
        <span class="c1"># n1, bins1, patches1 = ax1.hist(data, bins, alpha=0.6, density=False, cumulative=False)</span>
        <span class="c1"># # plot</span>
        <span class="c1"># self.plotWidget = FigureCanvas(self._figure)</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="p">)</span>
        <span class="n">dynamic_canvas</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">Figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_canvas</span> <span class="o">=</span> <span class="n">dynamic_canvas</span>
        <span class="c1">#self._figuerHost = host_subplot(111,figure=dynamic_canvas.figure)</span>
        <span class="c1">#self._figuerHost = host_subplot(111,figure=dynamic_canvas.figure,axes_class=AA.Axes)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">dynamic_canvas</span><span class="p">)</span>
        <span class="n">MainWindow</span><span class="o">.</span><span class="n">addToolBar</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">BottomToolBarArea</span><span class="p">,</span><span class="n">NavigationToolbar</span><span class="p">(</span><span class="n">dynamic_canvas</span><span class="p">,</span> <span class="n">MainWindow</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ax</span> <span class="o">=</span> <span class="n">dynamic_canvas</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">dynamic_canvas</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.05</span> <span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span>  <span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.register_callback_on_submit"><a class="viewcode-back" href="../../../api/garminmanager.ui.html#garminmanager.ui.MainGui.MainWindow.register_callback_on_submit">[docs]</a>    <span class="k">def</span> <span class="nf">register_callback_on_submit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">call_back</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_submit_callback</span> <span class="o">=</span> <span class="n">call_back</span></div>

<div class="viewcode-block" id="MainWindow.TransferToDatabase"><a class="viewcode-back" href="../../../api/garminmanager.ui.html#garminmanager.ui.MainGui.MainWindow.TransferToDatabase">[docs]</a>    <span class="k">def</span> <span class="nf">TransferToDatabase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">fileHandler</span> <span class="o">=</span> <span class="n">FileHandlerC</span><span class="p">()</span>

        <span class="c1"># Move activities</span>
        <span class="n">fileHandler</span><span class="o">.</span><span class="n">SetSrcFolder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="p">[</span><span class="s2">&quot;FitSourceFolder&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/ACTIVITY&quot;</span><span class="p">)</span>
        <span class="n">fileHandler</span><span class="o">.</span><span class="n">SetDstFolder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="p">[</span><span class="s2">&quot;FitDstFolder&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/GarminWatch/MyActivities&quot;</span><span class="p">)</span>
        <span class="n">fileHandler</span><span class="o">.</span><span class="n">Move</span><span class="p">()</span>

        <span class="c1"># Copy monitor data</span>
        <span class="n">fileHandler</span><span class="o">.</span><span class="n">SetSrcFolder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="p">[</span><span class="s2">&quot;FitSourceFolder&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/ACTIVITY&quot;</span><span class="p">)</span>
        <span class="n">fileHandler</span><span class="o">.</span><span class="n">SetDstFolder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="p">[</span><span class="s2">&quot;FitDstFolder&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/GarminWatch/Monitor&quot;</span><span class="p">)</span>
        <span class="n">fileHandler</span><span class="o">.</span><span class="n">Copy</span><span class="p">()</span>
        <span class="n">fileList</span> <span class="o">=</span> <span class="n">fileHandler</span><span class="o">.</span><span class="n">GetFileList</span><span class="p">()</span>

        <span class="c1"># ParseData</span>
        <span class="n">fitParser</span> <span class="o">=</span> <span class="n">FitParserC</span><span class="p">()</span>
        <span class="n">fitParser</span><span class="o">.</span><span class="n">SetFileList</span><span class="p">(</span><span class="n">fileList</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">itemType</span> <span class="ow">in</span> <span class="n">listOfTypes</span><span class="p">:</span>
            <span class="n">fitParser</span><span class="o">.</span><span class="n">SetType</span><span class="p">(</span><span class="n">itemType</span><span class="p">)</span>
            <span class="n">rawData</span> <span class="o">=</span> <span class="n">fitParser</span><span class="o">.</span><span class="n">GetData</span><span class="p">()</span>
            <span class="n">dataFilter</span> <span class="o">=</span> <span class="n">DataFilterC</span><span class="p">(</span><span class="n">rawData</span><span class="p">)</span>
            <span class="n">filterDataArray</span> <span class="o">=</span> <span class="n">dataFilter</span><span class="o">.</span><span class="n">GetData</span><span class="p">()</span>
            <span class="n">fileWriter</span> <span class="o">=</span> <span class="n">FileWriter</span><span class="p">(</span><span class="n">filterDataArray</span><span class="p">,</span><span class="n">itemType</span><span class="p">)</span>
            <span class="n">fileWriter</span><span class="o">.</span><span class="n">SetOutputPath</span><span class="p">(</span><span class="n">jsonFolder</span><span class="p">)</span>
            <span class="n">fileWriter</span><span class="o">.</span><span class="n">SetIntervallInHour</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
            <span class="c1"># Write last and first data as Name</span>
            <span class="c1"># Write Version number</span>
            <span class="c1"># Write Start</span>
            <span class="n">fileWriter</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">ProcessHeartrate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">generateData</span> <span class="o">=</span> <span class="n">GenerateData</span><span class="p">()</span>
        <span class="n">generatorSettings</span> <span class="o">=</span> <span class="n">GeneratorSettingsC</span><span class="p">()</span>
        <span class="n">generatorSettings</span><span class="o">.</span><span class="n">SetStartDateTime</span><span class="p">(</span><span class="n">startDateTime</span><span class="p">)</span>
        <span class="n">generatorSettings</span><span class="o">.</span><span class="n">SetEndDateTime</span><span class="p">(</span><span class="n">startDateTime</span><span class="p">)</span>
        <span class="n">generatorSettings</span><span class="o">.</span><span class="n">SetInput</span><span class="p">(</span><span class="n">inputFolder</span><span class="p">)</span>
        <span class="n">generateData</span><span class="o">.</span><span class="n">SetSettings</span><span class="p">(</span><span class="n">generatorSettings</span><span class="p">)</span>
        <span class="n">generateData</span><span class="o">.</span><span class="n">Process</span><span class="p">()</span>
        <span class="n">fitnessData</span> <span class="o">=</span> <span class="n">generateData</span><span class="o">.</span><span class="n">GetData</span><span class="p">()</span>
        <span class="n">statisticCalc</span> <span class="o">=</span> <span class="n">StatisticC</span><span class="p">(</span><span class="n">fitnessData</span><span class="p">)</span>
        <span class="n">statisticCalc</span><span class="o">.</span><span class="n">Calculate</span><span class="p">()</span>
        <span class="n">statisticData</span> <span class="o">=</span> <span class="n">statisticCalc</span><span class="o">.</span><span class="n">GetData</span><span class="p">()</span>
        <span class="n">plotData</span> <span class="o">=</span> <span class="n">PlotC</span><span class="p">(</span><span class="n">plotSettings</span><span class="p">,</span><span class="n">statisticData</span><span class="p">)</span>
        <span class="n">plotData</span><span class="o">.</span><span class="n">Plot</span><span class="p">()</span>

<div class="viewcode-block" id="MainWindow.TestFunction"><a class="viewcode-back" href="../../../api/garminmanager.ui.html#garminmanager.ui.MainGui.MainWindow.TestFunction">[docs]</a>    <span class="k">def</span> <span class="nf">TestFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Dialog</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.GetDataFromWatch"><a class="viewcode-back" href="../../../api/garminmanager.ui.html#garminmanager.ui.MainGui.MainWindow.GetDataFromWatch">[docs]</a>    <span class="k">def</span> <span class="nf">GetDataFromWatch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">src</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="p">[</span><span class="s2">&quot;FitSourceFolder&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/ACTIVITY&quot;</span>
        <span class="n">dst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="p">[</span><span class="s2">&quot;FitDstFolder&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/GarminWatch/MyActivities&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MoveFiles</span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="n">dst</span><span class="p">)</span>

        <span class="n">src</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="p">[</span><span class="s2">&quot;FitSourceFolder&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/MONITOR&quot;</span>
        <span class="n">dst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="p">[</span><span class="s2">&quot;FitDstFolder&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/GarminWatch/Monitor&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MoveFiles</span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="n">dst</span><span class="p">)</span></div>


<div class="viewcode-block" id="MainWindow.BackupData"><a class="viewcode-back" href="../../../api/garminmanager.ui.html#garminmanager.ui.MainGui.MainWindow.BackupData">[docs]</a>    <span class="k">def</span> <span class="nf">BackupData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">timestr</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">-%H%M%S&quot;</span><span class="p">)</span>
        <span class="n">src</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="p">[</span><span class="s2">&quot;FitDstFolder&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/GarminWatch&quot;</span>
        <span class="n">dst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="p">[</span><span class="s2">&quot;FitBackupFolder&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">timestr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Copytree</span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="n">dst</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.CopyFilesWithSubfolder"><a class="viewcode-back" href="../../../api/garminmanager.ui.html#garminmanager.ui.MainGui.MainWindow.CopyFilesWithSubfolder">[docs]</a>    <span class="k">def</span> <span class="nf">CopyFilesWithSubfolder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">src</span><span class="p">,</span><span class="n">dst</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dst</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>  <span class="c1"># replace the . with your starting directory</span>
            <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                <span class="n">path_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">copy2</span><span class="p">(</span><span class="n">path_file</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>  <span class="c1"># change you destination dir</span></div>

<div class="viewcode-block" id="MainWindow.Copytree"><a class="viewcode-back" href="../../../api/garminmanager.ui.html#garminmanager.ui.MainGui.MainWindow.Copytree">[docs]</a>    <span class="k">def</span> <span class="nf">Copytree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">symlinks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ignore</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">copytree</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">symlinks</span><span class="p">,</span> <span class="n">ignore</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">copy2</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.MoveFiles"><a class="viewcode-back" href="../../../api/garminmanager.ui.html#garminmanager.ui.MainGui.MainWindow.MoveFiles">[docs]</a>    <span class="k">def</span> <span class="nf">MoveFiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">src</span><span class="p">,</span><span class="n">dst</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dst</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>  <span class="c1"># replace the . with your starting directory</span>
            <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                <span class="n">path_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">path_file</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>  <span class="c1"># change you destination dir</span></div>

<div class="viewcode-block" id="MainWindow.PrintOverlay"><a class="viewcode-back" href="../../../api/garminmanager.ui.html#garminmanager.ui.MainGui.MainWindow.PrintOverlay">[docs]</a>    <span class="k">def</span> <span class="nf">PrintOverlay</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;c:</span><span class="se">\\</span><span class="s1">Users</span><span class="se">\\</span><span class="s1">schrma</span><span class="se">\\</span><span class="s1">Documents</span><span class="se">\\</span><span class="s1">20190223-fit-all</span><span class="se">\\</span><span class="s1">30731164854.fit&#39;</span>
        <span class="n">myPatternX1</span> <span class="o">=</span> <span class="s1">&#39;timestamp&#39;</span>
        <span class="n">myPatternY1</span> <span class="o">=</span> <span class="s1">&#39;current_activity_type_intensity&#39;</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">FitParserC</span><span class="p">()</span>
        <span class="n">m</span><span class="o">.</span><span class="n">ClearData</span><span class="p">()</span>
        <span class="n">m</span><span class="o">.</span><span class="n">SetFilename</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">xyPairIntensity</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">GetTimeRecordPairActivityTypeIntensity</span><span class="p">()</span>
        <span class="n">data1</span> <span class="o">=</span> <span class="n">xyPairIntensity</span><span class="o">.</span><span class="n">y</span>
        <span class="n">times1_raw</span> <span class="o">=</span> <span class="n">xyPairIntensity</span><span class="o">.</span><span class="n">x</span>

        <span class="c1"># Hear_rate</span>
        <span class="c1"># myPatternX2 = &#39;timestamp_16&#39;</span>
        <span class="c1"># myPatternY2 = &#39;heart_rate&#39;</span>
        <span class="c1"># m.ClearData()</span>
        <span class="c1"># firstTimestamp = m.GetRecordValue(&#39;timestamp&#39;)</span>
        <span class="c1"># myPairHeart = m.GetTimeRecordPairHeartbeat(myPatternX2, myPatternY2)</span>
        <span class="c1"># x = []</span>
        <span class="c1"># for selTime in myPairHeart.x:</span>
        <span class="c1">#     x = np.append(x, firstTimestamp + datetime.timedelta(seconds=selTime - myPairHeart.x[0]))</span>
        <span class="c1">#</span>
        <span class="c1"># data2 = myPairHeart.y;</span>
        <span class="c1"># times2_raw = x</span>

        <span class="c1"># Intensity</span>
        <span class="n">myPairHeart</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">GetTimeRecordPairHeartbeat</span><span class="p">()</span>
        <span class="n">data2</span> <span class="o">=</span> <span class="n">myPairHeart</span><span class="o">.</span><span class="n">y</span>
        <span class="n">times2_raw</span> <span class="o">=</span> <span class="n">myPairHeart</span><span class="o">.</span><span class="n">x</span>

        <span class="n">host</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ax</span>
        <span class="n">par1</span> <span class="o">=</span> <span class="n">host</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
        <span class="c1"># par2 = host.twinx()</span>
        <span class="c1">#</span>
        <span class="c1"># offset = 60</span>
        <span class="c1"># new_fixed_axis = par2.get_grid_helper().new_fixed_axis</span>
        <span class="c1"># par2.axis[&quot;right&quot;] = new_fixed_axis(loc=&quot;right&quot;,</span>
        <span class="c1">#                                      axes=par2,</span>
        <span class="c1">#                                      offset=(offset, 0))</span>
        <span class="c1"># par2.axis[&quot;right&quot;].toggle(all=True)</span>

        <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;tab:green&#39;</span>
        <span class="n">p1</span><span class="p">,</span> <span class="o">=</span> <span class="n">host</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times1_raw</span><span class="p">,</span> <span class="n">data1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
        <span class="n">host</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
        <span class="n">host</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Intensity&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
        <span class="n">host</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>

        <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;tab:blue&#39;</span>
        <span class="n">p2</span><span class="p">,</span> <span class="o">=</span> <span class="n">par1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times2_raw</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span>
        <span class="n">par1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Heartrate&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
        <span class="n">par1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>

        <span class="n">host</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

        <span class="n">host</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1"> %H:%M&#39;</span><span class="p">))</span>
        <span class="n">host</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">HourLocator</span><span class="p">())</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">host</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_majorticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>

        <span class="n">host</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.ProcessHeartrate"><a class="viewcode-back" href="../../../api/garminmanager.ui.html#garminmanager.ui.MainGui.MainWindow.ProcessHeartrate">[docs]</a>    <span class="k">def</span> <span class="nf">ProcessHeartrate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">myPattern</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;time_created&#39;</span><span class="p">,</span><span class="s1">&#39;activity_type&#39;</span><span class="p">,</span><span class="s1">&#39;intensity&#39;</span><span class="p">,</span><span class="s1">&#39;heart_rate&#39;</span><span class="p">]</span>
        <span class="n">outputName</span> <span class="o">=</span> <span class="s1">&#39;summary.txt&#39;</span>
        <span class="c1">#d = self._getFileList()</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;timezone&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;GMT+1&#39;</span>
        <span class="n">foldername</span> <span class="o">=</span> <span class="s1">&#39;c:</span><span class="se">\\</span><span class="s1">Users</span><span class="se">\\</span><span class="s1">schrma</span><span class="se">\\</span><span class="s1">Documents</span><span class="se">\\</span><span class="s1">20190223-fit-all&#39;</span>
        <span class="n">foldername</span> <span class="o">=</span> <span class="s1">&#39;c:</span><span class="se">\\</span><span class="s1">Users</span><span class="se">\\</span><span class="s1">schrma</span><span class="se">\\</span><span class="s1">ownCloud</span><span class="se">\\</span><span class="s1">leica</span><span class="se">\\</span><span class="s1">fitfolder</span><span class="se">\\</span><span class="s1">GarminWatch</span><span class="se">\\</span><span class="s1">Monitor&#39;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getFileList</span><span class="p">(</span><span class="n">foldername</span><span class="p">)</span>
        <span class="n">filenameList</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;names&#39;</span><span class="p">]</span>
        <span class="n">fitFolder</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;folder&#39;</span><span class="p">]</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">FitParserC</span><span class="p">()</span>
        <span class="n">myPatternX</span> <span class="o">=</span> <span class="s1">&#39;timestamp_16&#39;</span>
        <span class="n">myPatternY</span> <span class="o">=</span> <span class="s1">&#39;heart_rate&#39;</span>
        <span class="n">m</span><span class="o">.</span><span class="n">ClearData</span><span class="p">()</span>
        <span class="n">m</span><span class="o">.</span><span class="n">SetFilename</span><span class="p">(</span><span class="n">fitFolder</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">filenameList</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">firstTimestamp</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">GetValueOfFirstOccurence</span><span class="p">(</span><span class="s1">&#39;timestamp&#39;</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">m</span><span class="o">.</span><span class="n">ClearData</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenameList</span><span class="p">:</span>
            <span class="n">m</span><span class="o">.</span><span class="n">SetFilename</span><span class="p">(</span><span class="n">fitFolder</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
            <span class="c1">#m.ClearData()</span>

            <span class="n">xyPair</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">GetTimeRecordPairHeartbeat</span><span class="p">()</span>

        <span class="n">data1</span> <span class="o">=</span> <span class="n">xyPair</span><span class="o">.</span><span class="n">y</span>
        <span class="n">times1_raw</span> <span class="o">=</span> <span class="n">xyPair</span><span class="o">.</span><span class="n">x</span>

        <span class="n">host</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ax</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;tab:green&#39;</span>
        <span class="n">p1</span><span class="p">,</span> <span class="o">=</span> <span class="n">host</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times1_raw</span><span class="p">,</span> <span class="n">data1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
        <span class="n">host</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
        <span class="n">host</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">myPatternY</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
        <span class="n">host</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis_date</span><span class="p">(</span><span class="n">tz</span><span class="o">.</span><span class="n">tzlocal</span><span class="p">())</span>
        <span class="c1">#host.xaxis.set_title(&quot;3 - tzinfo NO, xaxis_date = YES, formatter=NO&quot;)</span>
        <span class="n">host</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1"> %H:%M&#39;</span><span class="p">))</span>
        <span class="n">host</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">HourLocator</span><span class="p">())</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">host</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_majorticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>

        <span class="n">host</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>


<div class="viewcode-block" id="MainWindow.ParseOverAll"><a class="viewcode-back" href="../../../api/garminmanager.ui.html#garminmanager.ui.MainGui.MainWindow.ParseOverAll">[docs]</a>    <span class="k">def</span> <span class="nf">ParseOverAll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">myPattern</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">,</span><span class="s1">&#39;current_activity_type_intensity&#39;</span><span class="p">,</span><span class="s1">&#39;timestamp_16&#39;</span><span class="p">]</span>
        <span class="n">outputName</span> <span class="o">=</span> <span class="s1">&#39;summary.txt&#39;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getFileList</span><span class="p">()</span>
        <span class="c1">#d = self._getFileList(&#39;c:\\Users\\schrma\\Documents\\20190223-1016-small&#39;)</span>
        <span class="n">filenameList</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;names&#39;</span><span class="p">]</span>
        <span class="n">fitFolder</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;folder&#39;</span><span class="p">]</span>
        <span class="n">txtFolder</span> <span class="o">=</span> <span class="n">fitFolder</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">all</span><span class="se">\\</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">txtFolder</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">txtFolder</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">FitParserC</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenameList</span><span class="p">:</span>
            <span class="n">m</span><span class="o">.</span><span class="n">ClearData</span><span class="p">()</span>
            <span class="n">m</span><span class="o">.</span><span class="n">SetFilename</span><span class="p">(</span><span class="n">fitFolder</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
            <span class="n">m</span><span class="o">.</span><span class="n">ParseByPattern</span><span class="p">(</span><span class="n">myPattern</span><span class="p">)</span>
        <span class="n">outputNameFull</span> <span class="o">=</span> <span class="n">txtFolder</span> <span class="o">+</span> <span class="n">outputName</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">outputNameFull</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">PrintAll</span><span class="p">()</span>
        <span class="n">m</span><span class="o">.</span><span class="n">SetOuputName</span><span class="p">(</span><span class="n">outputNameFull</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">WriteToFileOverall</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.ParseAndWrite"><a class="viewcode-back" href="../../../api/garminmanager.ui.html#garminmanager.ui.MainGui.MainWindow.ParseAndWrite">[docs]</a>    <span class="k">def</span> <span class="nf">ParseAndWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getFileList</span><span class="p">()</span>
        <span class="c1">#d = self._getFileList(&#39;c:\\Users\\schrma\\Documents\\20190223-1016-fit&#39;)</span>
        <span class="n">filenameList</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;names&#39;</span><span class="p">]</span>
        <span class="n">fitFolder</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;folder&#39;</span><span class="p">]</span>
        <span class="n">txtFolder</span> <span class="o">=</span> <span class="n">fitFolder</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">txt</span><span class="se">\\</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">txtFolder</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">txtFolder</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenameList</span><span class="p">:</span>
            <span class="n">outputName</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="n">outputName</span> <span class="o">=</span> <span class="n">txtFolder</span> <span class="o">+</span> <span class="n">outputName</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.fit&quot;</span><span class="p">,</span> <span class="s2">&quot;.txt&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">outputName</span><span class="p">)</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">FitParserC</span><span class="p">()</span>
            <span class="n">m</span><span class="o">.</span><span class="n">SetFilename</span><span class="p">(</span><span class="n">fitFolder</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
            <span class="n">m</span><span class="o">.</span><span class="n">SetOuputName</span><span class="p">(</span><span class="n">outputName</span><span class="p">)</span>
            <span class="n">m</span><span class="o">.</span><span class="n">ParseFile</span><span class="p">()</span>
            <span class="n">m</span><span class="o">.</span><span class="n">WriteToFileSingle</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_on_file_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filenameList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_files</span><span class="p">()</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">filenameList</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenameList</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getFileList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">selectedFolder</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">selectedFolder</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">selectedFolder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_folder</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">selectedFolder</span><span class="p">)</span>
        <span class="n">fullName</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">onlyfiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">listdir</span><span class="p">(</span><span class="n">selectedFolder</span><span class="p">)</span> <span class="k">if</span> <span class="n">isfile</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">selectedFolder</span><span class="p">,</span> <span class="n">f</span><span class="p">))]</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">onlyfiles</span><span class="p">:</span>
            <span class="n">fullName</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">selectedFolder</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>

        <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">();</span>
        <span class="n">d</span><span class="p">[</span><span class="s1">&#39;fullNames&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fullName</span>
        <span class="n">d</span><span class="p">[</span><span class="s1">&#39;names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">onlyfiles</span>
        <span class="n">d</span><span class="p">[</span><span class="s1">&#39;folder&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">selectedFolder</span>
        <span class="k">return</span> <span class="n">d</span>

    <span class="k">def</span> <span class="nf">_get_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">dlg</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="p">()</span>
        <span class="n">folder</span> <span class="o">=</span> <span class="n">dlg</span><span class="o">.</span><span class="n">getExistingDirectory</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">folder</span>

    <span class="k">def</span> <span class="nf">_get_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">dlg</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="p">()</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">setFileMode</span><span class="p">(</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">AnyFile</span><span class="p">)</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">setFilter</span><span class="p">(</span><span class="n">QDir</span><span class="o">.</span><span class="n">Files</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">dlg</span><span class="o">.</span><span class="n">exec_</span><span class="p">():</span>
            <span class="n">file_names</span> <span class="o">=</span> <span class="n">dlg</span><span class="o">.</span><span class="n">selectedFiles</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">file_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">file_names</span></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">garminmanager</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/modules.html">Module Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, schrma.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>